import{r,j as e}from"./radix-ui-g4Zjb45b.js";import{u as D,C as y,c as v,B as C,a as I,b as q,e as Y,L as p,I as f,A as z,v as G}from"./index-Di0QTi5H.js";import{A as H,a as U}from"./alert-8JZEACBP.js";import{a as X,c as Z,L as g}from"./vendor-5D3NlFB3.js";import{m as j}from"./animations-Cl6lmbPg.js";import{C as l}from"./circle-check-Bt4IzOAM.js";import{C as J}from"./circle-alert-KNhF9Ogk.js";import{L as k}from"./lock-B-MYdu84.js";import{E as P,a as S}from"./eye-BjYCeDat.js";import{C as d}from"./circle-x-DRdwssQI.js";import{L as K}from"./loader-circle-tVcG7Y-8.js";function ne(){const w=X(),[m]=Z(),{resetPassword:L,isLoading:o}=D(),[x,N]=r.useState(""),[t,A]=r.useState(""),[n,E]=r.useState(""),[u,F]=r.useState(!1),[h,R]=r.useState(!1),[b,c]=r.useState(""),[$,O]=r.useState(!1),a={length:t.length>=8,uppercase:/[A-Z]/.test(t),lowercase:/[a-z]/.test(t),number:/[0-9]/.test(t),special:/[!@#$%^&*(),.?":{}|<>]/.test(t)},i=Object.values(a).filter(Boolean).length,B=()=>i<=2?"text-red-500 bg-red-500":i<=3?"text-yellow-500 bg-yellow-500":i<=4?"text-blue-500 bg-blue-500":"text-green-500 bg-green-500";r.useEffect(()=>{const s=m.get("token");s&&N(s)},[m]);const T=async s=>{if(s.preventDefault(),c(""),!x){c("Invalid or missing reset token.");return}if(!t||!n){c("Please fill in all fields.");return}if(t!==n){c("Passwords do not match.");return}if(i<3){c("Please create a stronger password.");return}await L(x,t)&&(O(!0),setTimeout(()=>{w("/auth/login")},3e3))};return $?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(j.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:e.jsx(y,{className:"border-border/50 shadow-xl shadow-black/5",children:e.jsxs(v,{className:"pt-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(l,{className:"h-8 w-8 text-green-500"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Password Reset Successful!"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your password has been reset successfully. You'll be redirected to the login page shortly."}),e.jsx(C,{onClick:()=>w("/auth/login"),className:"w-full",children:"Go to Login"})]})})})})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx(j.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:e.jsxs(g,{to:"/",className:"inline-flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"S"})}),e.jsx("span",{className:"text-xl font-bold text-foreground",children:"Sovereon"})]})}),e.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(y,{className:"border-border/50 shadow-xl shadow-black/5",children:[e.jsxs(I,{className:"space-y-1",children:[e.jsx(q,{className:"text-2xl font-bold text-center",children:"Create new password"}),e.jsx(Y,{className:"text-center",children:"Enter your new password below"})]}),e.jsxs(v,{className:"space-y-4",children:[!m.get("token")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"token",children:"Reset Token"}),e.jsx(f,{id:"token",type:"text",placeholder:"Enter your reset token",value:x,onChange:s=>N(s.target.value),disabled:o}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For demo: Check sessionStorage for your reset token"})]}),b&&e.jsxs(H,{variant:"destructive",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(U,{children:b})]}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(f,{id:"password",type:u?"text":"password",placeholder:"Create a strong password",value:t,onChange:s=>A(s.target.value),className:"pl-10 pr-10",disabled:o,required:!0}),e.jsx("button",{type:"button",onClick:()=>F(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:u?e.jsx(P,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})})]}),t&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${s<=i?B():"bg-muted"}`},s))}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:`flex items-center gap-1 ${a.length?"text-green-500":"text-muted-foreground"}`,children:[a.length?e.jsx(l,{className:"h-3 w-3"}):e.jsx(d,{className:"h-3 w-3"}),"At least 8 characters"]}),e.jsxs("div",{className:`flex items-center gap-1 ${a.uppercase?"text-green-500":"text-muted-foreground"}`,children:[a.uppercase?e.jsx(l,{className:"h-3 w-3"}):e.jsx(d,{className:"h-3 w-3"}),"One uppercase letter"]}),e.jsxs("div",{className:`flex items-center gap-1 ${a.lowercase?"text-green-500":"text-muted-foreground"}`,children:[a.lowercase?e.jsx(l,{className:"h-3 w-3"}):e.jsx(d,{className:"h-3 w-3"}),"One lowercase letter"]}),e.jsxs("div",{className:`flex items-center gap-1 ${a.number?"text-green-500":"text-muted-foreground"}`,children:[a.number?e.jsx(l,{className:"h-3 w-3"}):e.jsx(d,{className:"h-3 w-3"}),"One number"]}),e.jsxs("div",{className:`flex items-center gap-1 ${a.special?"text-green-500":"text-muted-foreground"}`,children:[a.special?e.jsx(l,{className:"h-3 w-3"}):e.jsx(d,{className:"h-3 w-3"}),"One special character"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(f,{id:"confirmPassword",type:h?"text":"password",placeholder:"Confirm your password",value:n,onChange:s=>E(s.target.value),className:"pl-10 pr-10",disabled:o,required:!0}),e.jsx("button",{type:"button",onClick:()=>R(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:h?e.jsx(P,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})})]}),n&&t!==n&&e.jsx("p",{className:"text-xs text-red-500",children:"Passwords do not match"})]}),e.jsx(C,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-2 h-4 w-4 animate-spin"}),"Resetting password..."]}):e.jsxs(e.Fragment,{children:["Reset password",e.jsx(z,{className:"ml-2 h-4 w-4"})]})})]})]}),e.jsxs(G,{className:"flex flex-col space-y-4",children:[e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["Remember your password?"," ",e.jsx(g,{to:"/auth/login",className:"text-primary hover:text-primary/80 font-medium transition-colors",children:"Sign in"})]}),e.jsx(g,{to:"/",className:"text-center text-sm text-muted-foreground hover:text-foreground transition-colors",children:"‚Üê Back to homepage"})]})]})})]})})}export{ne as default};
